<?php
/**
 * Session Class Doc Comment
 *
 * @category	Class
 * @package		Model
 * @author		bryyce
 * @license		http://www.gnu.org/copyleft/gpl.html GNU General Public License
 * @link		http://www.bryyce.fr/
 */
namespace Model;
class Session
{
    private static $_user;
    public static function CreateSession()
    {
		session_start();
		if(!isset($_SESSION['id'])) {
			session_destroy();
			return false;
		}
                Session::$_user=new User($_SESSION['id']);
		return true;
    }
    public static function CreateSessionOrDie($page){
        if(!self::CreateSession()){
            header('Location: /'.$page);
            exit;
        }
    }
    public static function CreateAdminSessionOrDie($page){
        if(!self::CreateSession() || !Session::isAdmin()){
            header('Location: /'.$page);
            exit;
        }
    }
    public static function isAdmin(){
        return Session::$_user->isAdmin();
    }
    public static function currentUser(){
        return Session::$_user;
    }
}
?>
